<!-- JSON-LD Schema for SEO -->
{% if page.json_ld %}
<script type="application/ld+json">
{{ page.json_ld | jsonify }}
</script>
{% endif %}

<!-- Meta description -->
{% if page.description %}
<meta name="description" content="{{ page.description | truncate: 155 }}">
<meta property="og:description" content="{{ page.description | truncate: 155 }}">
<meta name="twitter:description" content="{{ page.description | truncate: 155 }}">
{% endif %}

<!-- Open Graph tags -->
<meta property="og:title" content="{{ page.title | default: site.title }}">
<meta property="og:type" content="article">
<meta property="og:url" content="{{ page.url | absolute_url }}">
<meta property="og:site_name" content="{{ site.title }}">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="{{ page.title | default: site.title }}">

<!-- Custom styles for navigation dates -->
<style>
/* Navigation item with date - use flexbox for right-alignment */
/* Use !important to override Just the Docs theme styles */
.site-nav .nav-list-item > .nav-list-link {
  display: flex !important;
  justify-content: space-between !important;
  align-items: center !important;
  width: 100% !important;
}

.nav-date {
  font-size: 0.75em !important;
  color: #959396 !important;
  margin-left: auto !important;
  padding-left: 1em !important;
  white-space: nowrap !important;
  flex-shrink: 0 !important;
}

/* Prevent title from taking full width */
.nav-title {
  flex-grow: 1 !important;
}

/* SEO/SGE marker styles */
.key-answer {
  background-color: #f8f9fa;
  border-left: 4px solid #2563eb;
  padding: 1em;
  margin: 1em 0;
}

.key-answer strong {
  color: #1e40af;
}

.key-takeaway {
  background-color: #fef3c7;
  border-radius: 8px;
  padding: 1em;
  margin: 1em 0;
}

.expert-quote {
  border-left: 4px solid #6b7280;
  padding-left: 1em;
  font-style: italic;
  color: #4b5563;
}

.expert-quote cite {
  display: block;
  margin-top: 0.5em;
  font-style: normal;
  font-weight: 600;
}

.actionable-steps {
  background-color: #ecfdf5;
  border-radius: 8px;
  padding: 1em 1em 1em 2em;
}

.comparison-table {
  width: 100%;
  border-collapse: collapse;
}

.comparison-table th,
.comparison-table td {
  border: 1px solid #e5e7eb;
  padding: 0.5em;
}

.comparison-table th {
  background-color: #f3f4f6;
}

/* Disclaimer styles */
.disclaimer {
  background-color: #fef2f2;
  border: 1px solid #fecaca;
  border-radius: 8px;
  padding: 1em;
  margin-top: 2em;
  font-size: 0.9em;
  color: #991b1b;
}

.disclaimer strong {
  display: block;
  margin-bottom: 0.5em;
}
</style>

<script>
// Parse navigation titles and separate dates to right-align them
function formatNavDates() {
  const datePattern = /^(.+?)\s+(\d{4}-\d{2}-\d{2})$/;

  document.querySelectorAll('.nav-list-link').forEach(function(link) {
    // Skip if already processed
    if (link.querySelector('.nav-date')) return;

    const text = link.textContent.trim();
    const match = text.match(datePattern);

    if (match) {
      const title = match[1];
      const date = match[2];

      // Clear existing content
      link.textContent = '';

      // Add title span
      const titleSpan = document.createElement('span');
      titleSpan.className = 'nav-title';
      titleSpan.textContent = title;
      link.appendChild(titleSpan);

      // Add date span
      const dateSpan = document.createElement('span');
      dateSpan.className = 'nav-date';
      dateSpan.textContent = date;
      link.appendChild(dateSpan);
    }
  });
}

// Run on DOMContentLoaded
document.addEventListener('DOMContentLoaded', formatNavDates);

// Also run after a short delay in case nav is loaded dynamically
setTimeout(formatNavDates, 100);
setTimeout(formatNavDates, 500);

// Use MutationObserver to catch dynamic nav changes
if (typeof MutationObserver !== 'undefined') {
  const observer = new MutationObserver(function(mutations) {
    formatNavDates();
  });
  document.addEventListener('DOMContentLoaded', function() {
    const nav = document.querySelector('.site-nav');
    if (nav) {
      observer.observe(nav, { childList: true, subtree: true });
    }
  });
}
</script>
